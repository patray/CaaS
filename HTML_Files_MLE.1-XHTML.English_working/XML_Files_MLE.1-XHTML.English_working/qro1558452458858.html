<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="copyright" content="(C) Copyright 2019, Teradata. All Rights Reserved." />
<meta name="DC.rights.owner" content="(C) Copyright 2019, Teradata. All Rights Reserved." />
<meta name="DC.Type" content="concept" />
<meta name="DC.Title" content="MultiCaseMatch" />
<meta name="abstract" content="This Machine Learning Engine function extends SQL CASE statement by supporting matches to multiple options and iterating through input data set only once." />
<meta name="description" content="This Machine Learning Engine function extends SQL CASE statement by supporting matches to multiple options and iterating through input data set only once." />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="eju1507835240829" />
<meta name="DC.Language" content="en-us" />

<link rel="stylesheet" type="text/css" href="css/normal_styles.css" />
<title>MultiCaseMatch</title>
</head>
<body>
<div class="nested0" aria-labelledby="ariaid-title1" topicindex="1" topicid="eju1507835240829" id="eju1507835240829">
	<h1 class="title topictitle1" id="ariaid-title1">MultiCaseMatch</h1>

	<div class="body conbody">
		<p class="p">The MultiCaseMatch function extends the capability of the SQL CASE statement by supporting matches to multiple criteria in a single row.</p>

		<p class="p">When SQL CASE finds a match, it outputs the result and immediately
			proceeds to the next row without searching for more matches in the current row.</p>

		<p class="p">The MultiCaseMatch function iterates through the input data set only once and outputs matches whenever a match occurs. If multiple matches occur for a given input row, the function outputs one output row for each match.</p>

		<p class="p">Use the MultiCaseMatch function when the conditions in your CASE statement do not form a mutually exclusive set.</p>

	</div>

<div class="topic reference nested1" aria-labelledby="ariaid-title2" topicindex="2" topicid="mdj1507835568043" xml:lang="en-us" lang="en-us" id="mdj1507835568043"><h2 class="title topictitle2" id="ariaid-title2">MultiCaseMatch Syntax</h2>
<div class="body refbody"><div class="section" id="mdj1507835568043__section_N1000E_N1000C_N10001"><h3 class="title sectiontitle">Version 1.5</h3><pre class="pre codeblock"><code>SELECT * FROM MultiCaseMatch (
  ON (SELECT t.*, <var class="keyword varname">condition</var> AS <var class="keyword varname">case</var> [,...] FROM { <var class="keyword varname">table</var> | <var class="keyword varname">view</var> | (<var class="keyword varname">query</var>) } AS t)
  USING
  Labels ('<var class="keyword varname">case</var> AS "<var class="keyword varname">label</var>"' [,...])
) AS <var class="keyword varname">alias</var>;</code></pre></div>
</div>
</div>
<div class="topic reference nested1" aria-labelledby="ariaid-title3" topicindex="3" topicid="xqa1507835573379" xml:lang="en-us" lang="en-us" id="xqa1507835573379">
	<h2 class="title topictitle2" id="ariaid-title3">MultiCaseMatch Syntax Elements</h2>

	<div class="body refbody">
		<div class="section" id="xqa1507835573379__section_N10011_N1000E_N10001"><dl class="dl parml"><dt class="dt pt dlterm">Labels</dt>
<dd class="dd pd">Specify a label for each <var class="keyword varname">case</var>. Each case corresponds to a <var class="keyword varname">condition</var>, which is a SQL predicate that includes input column names. When an input value satisfies <var class="keyword varname">condition</var>, that is a match, and the function outputs the input row and the corresponding label.</dd>
</dl>
</div>

	</div>

</div>
<div class="topic reference nested1" aria-labelledby="ariaid-title4" topicindex="4" topicid="nvl1507835618904" xml:lang="en-us" lang="en-us" id="nvl1507835618904"><h2 class="title topictitle2" id="ariaid-title4">MultiCaseMatch Input</h2>
<div class="body refbody"><div class="section" id="nvl1507835618904__section_pds_mhs_ycb"><h3 class="title sectiontitle">Input Table Schema</h3>
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="nvl1507835618904__table_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup><col style="width:22.22222222222222%" /><col style="width:11.11111111111111%" /><col style="width:66.66666666666666%" /></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d394682e142">Column</th>
<th class="entry nocellnorowborder" style="vertical-align:top;" id="d394682e144">Data Type</th>
<th class="entry cell-norowborder" style="vertical-align:top;" id="d394682e146">Description</th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d394682e142 "><var class="keyword varname">column_in_condition</var></td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d394682e144 ">Any</td>
<td class="entry cell-norowborder" style="vertical-align:top;" headers="d394682e146 ">[Column appears once for each column specified in a <var class="keyword varname">condition</var>.]</td>
</tr>
<tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d394682e142 "><var class="keyword varname">other_column</var></td>
<td class="entry row-nocellborder" style="vertical-align:top;" headers="d394682e144 ">Any</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e146 ">[Column appears zero or more times.] <span class="ph">Column to copy to output table.</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="topic reference nested1" aria-labelledby="ariaid-title5" topicindex="5" topicid="nug1507835578504" xml:lang="en-us" lang="en-us" id="nug1507835578504"><h2 class="title topictitle2" id="ariaid-title5">MultiCaseMatch Output</h2>
<div class="body refbody"><div class="section" id="nug1507835578504__section_psy_khs_ycb"><h3 class="title sectiontitle">Output Table Schema</h3>
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="nug1507835578504__table_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup><col style="width:20%" /><col style="width:13.333333333333334%" /><col style="width:66.66666666666666%" /></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d394682e189">Column</th>
<th class="entry nocellnorowborder" style="vertical-align:top;" id="d394682e191">Data Type</th>
<th class="entry cell-norowborder" style="vertical-align:top;" id="d394682e193">Description</th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d394682e189 "><var class="keyword varname">column_in_condition</var></td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d394682e191 "><span class="ph">Same as in Input table</span></td>
<td class="entry cell-norowborder" style="vertical-align:top;" headers="d394682e193 ">[Column appears once for each column specified in a <var class="keyword varname">condition</var>.] <span class="ph">Column copied from input table.</span></td>
</tr>
<tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d394682e189 ">labels</td>
<td class="entry row-nocellborder" style="vertical-align:top;" headers="d394682e191 ">VARCHAR</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e193 ">[Column appears once for each matching label.] Labels that correspond to case that <var class="keyword varname">column_in_condition</var> value matches.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="topic reference nested1" aria-labelledby="ariaid-title6" topicindex="6" topicid="eej1507836139044" xml:lang="en-us" lang="en-us" id="eej1507836139044"><h2 class="title topictitle2" id="ariaid-title6">MultiCaseMatch Example</h2>
<div class="body refbody"><div class="section" id="eej1507836139044__section_N10011_N1000E_N10001"><p class="p">This example labels people with the age groups to which they belong, which overlap:</p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="eej1507836139044__table_qhz_jyw_v1b" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup><col style="width:50%" /><col style="width:50%" /></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d394682e249">Age Group</th>
<th class="entry cellrowborder" style="vertical-align:top;" id="d394682e251">Description</th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e249 ">infant</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e251 ">Younger than 1 year</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e249 ">toddler</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e251 ">1-2 years, inclusive</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e249 ">kid</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e251 ">2-12 years, inclusive</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e249 ">teenager</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e251 ">13-19 years, inclusive</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e249 ">young adult</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e251 ">16-25 years, inclusive</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e249 ">adult</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e251 ">21-40 years, inclusive</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e249 ">middle-aged person</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e251 ">35-60 years, inclusive</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e249 ">senior citizen</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e251 ">60 years or older</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="eej1507836139044__section_cc1_gf3_xdb"><h3 class="title sectiontitle">Input</h3>
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="eej1507836139044__table_mdv_jf3_xdb" class="table" frame="border" border="1" rules="all"><div class="caption"><span class="tablecap">people_age</span></div><colgroup><col style="width:33.33333333333333%" /><col style="width:33.33333333333333%" /><col style="width:33.33333333333333%" /></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d394682e306">id</th>
<th class="entry cellrowborder" style="vertical-align:top;" id="d394682e308">name</th>
<th class="entry cellrowborder" style="vertical-align:top;" id="d394682e310">age</th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e306 ">1</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e308 ">John</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e310 ">0.5</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e306 ">2</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e308 ">Freddy</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e310 ">2</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e306 ">3</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e308 ">Marie</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e310 ">6</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e306 ">4</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e308 ">Tom Sawyer</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e310 ">17</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e306 ">5</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e308 ">Becky Thatcher</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e310 ">16</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e306 ">6</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e308 ">Philip</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e310 ">22</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e306 ">7</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e308 ">Joseph</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e310 ">25</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e306 ">8</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e308 ">Roger</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e310 ">35</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e306 ">9</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e308 ">Natalie</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e310 ">30</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e306 ">10</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e308 ">Henry</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e310 ">40</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e306 ">11</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e308 ">George</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e310 ">50</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e306 ">12</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e308 ">Sir William</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d394682e310 ">65</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="eej1507836139044__section_eqk_gf3_xdb"><h3 class="title sectiontitle">SQL Call</h3><pre class="pre codeblock"><code>SELECT * FROM MultiCaseMatch (
ON (SELECT t.*, 
   (case when t.age &lt; 1 THEN '1' ELSE '0' END) AS case1,
   (case when t.age &gt;= 1 AND t.age &lt;= 2 THEN '1' ELSE '0' END) AS case2,
   (case when t.age &gt;= 2 AND t.age &lt;= 12 THEN '1' ELSE '0' END) AS case3,
   (case when t.age &gt;= 13 AND t.age &lt;= 19 THEN '1' ELSE '0' END) AS case4,
   (case when t.age &gt;= 16 AND t.age &lt;= 25 THEN '1' ELSE '0' END) AS case5,
   (case when t.age &gt;= 21 AND t.age &lt;= 40 THEN '1' ELSE '0' END) AS case6,
   (case when t.age &gt;= 35 AND t.age &lt;= 60 THEN '1' ELSE '0' END) AS case7,
   (case when t.age &gt;= 60 THEN '1' ELSE '0' END) AS case8
   FROM people_age AS t)
USING
   LABELS (
     'case1 AS "infant"',
     'case2 AS "toddler"',
     'case3 AS "kid"',
     'case4 AS "teenager"',
     'case5 AS "young adult"',
     'case6 AS "adult"',
     'case7 AS "middle aged person"',
     'case8 AS "senior citizen"')
  ) AS dt;</code></pre></div>
<div class="section" id="eej1507836139044__section_a1x_gf3_xdb"><h3 class="title sectiontitle">Output</h3><p class="p">Several people have two labels. For example, Freddy is both a toddler and a kid, and Tom Sawyer and Becky Thatcher are both teenagers and young adults.</p>
<pre class="pre screen"> id name           age  labels             
 -- -------------- ---- ------------------ 
  7 joseph         25.0 young adult       
  6 philip         22.0 young adult       
  7 joseph         25.0 adult             
  6 philip         22.0 adult             
 12 sir william    65.0 senior citizen    
 11 george         50.0 middle aged person
  4 tom sawyer     17.0 teenager          
  9 natalie        30.0 adult             
  4 tom sawyer     17.0 young adult       
 10 henry          40.0 adult             
  5 becky thatcher 16.0 teenager          
 10 henry          40.0 middle aged person
  5 becky thatcher 16.0 young adult       
  3 marie           6.0 kid               
  1 john            0.5 infant            
  8 roger          35.0 adult             
  8 roger          35.0 middle aged person
  2 freddy          2.0 toddler           
  2 freddy          2.0 kid</pre>
<p class="p">Download a zip file of all examples and a SQL script file that creates their input tables from the download tab <img class="image" id="eej1507836139044__d21e16" src="enx1538431836629.png" /> in the left pane.</p>
</div>
</div>
</div>
</div>
</body>
</html>