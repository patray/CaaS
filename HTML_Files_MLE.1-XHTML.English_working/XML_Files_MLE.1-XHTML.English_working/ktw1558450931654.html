<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="copyright" content="(C) Copyright 2019, Teradata. All Rights Reserved." />
<meta name="DC.rights.owner" content="(C) Copyright 2019, Teradata. All Rights Reserved." />
<meta name="DC.Type" content="concept" />
<meta name="DC.Title" content="IPGeo" />
<meta name="abstract" content="This Machine Learning Engine function maps IP addresses to information that you can use to identify the geographical location of a visitor." />
<meta name="description" content="This Machine Learning Engine function maps IP addresses to information that you can use to identify the geographical location of a visitor." />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="cuu1507837727412" />
<meta name="DC.Language" content="en-us" />

<link rel="stylesheet" type="text/css" href="css/normal_styles.css" />
<title>IPGeo</title>
</head>
<body>
<div class="nested0" aria-labelledby="ariaid-title1" topicindex="1" topicid="cuu1507837727412" id="cuu1507837727412">
	<h1 class="title topictitle1" id="ariaid-title1">IPGeo</h1>

	<div class="body conbody">
		<p class="p">IPGeo lets you map IP addresses to location information (country, region,
			city, latitude, longitude, ZIP code, and ISP).</p>

		<p class="p">You can use the locations of web site visitors to improve the
			effectiveness of online applications. For example:</p>

		<ul class="ul" id="cuu1507837727412__ul_ymb_4yk_r1b">
			<li class="li">Targeted online advertising</li>

			<li class="li">Content localization</li>

			<li class="li">Geographic rights management</li>

			<li class="li">Enhanced analytics</li>

			<li class="li">Online security and fraud prevention</li>

		</ul>

		<p class="p">For general information about IP databases, see:</p>

		<p class="p"><a class="xref" href="http://dev.maxmind.com/geoip/geoip2/geolite2/" target="_blank" title="">http://dev.maxmind.com/geoip/geoip2/geolite2/</a></p>
<div class="note note" id="cuu1507837727412__note_N10049_N10010_N10001"><span class="notetitle">Note</span><div class="notebody">IPGeo uses files that are preinstalled on <span class="keyword">ML Engine</span>. For details, see <a class="xref" href="tzu1557778477026.html" title="See a table of preinstalled files that Machine Learning Engine analytic functions use.">Preinstalled Files That Functions Use</a>.</div></div>

	</div>

<div class="topic reference nested1" aria-labelledby="ariaid-title2" topicindex="2" topicid="fdo1507837763672" xml:lang="en-us" lang="en-us" id="fdo1507837763672"><h2 class="title topictitle2" id="ariaid-title2">IPGeo Syntax</h2>
<div class="body refbody"><div class="section" id="fdo1507837763672__section_N1000E_N1000C_N10001"><h3 class="title sectiontitle">Version 2.4</h3><pre class="pre codeblock"><code>SELECT * FROM IPGeo (
  <span class="ph">ON { <var class="keyword varname">table</var> | <var class="keyword varname">view</var> | (<var class="keyword varname">query</var>) }</span>
  USING
  IPAddressColumn ('<var class="keyword varname">ip_address_column</var>')
  [ Converter ('<var class="keyword varname">file</var>', '<var class="keyword varname">class</var>') ]
  <code class="ph codeph">[ Accumulate ({ '<var class="keyword varname">accumulate_column</var>' | <var class="keyword varname">accumulate_column_range</var> }[,...]) ]</code>
) AS <var class="keyword varname">alias</var>;</code></pre></div>
</div>
<div class="related-links">
<div class="linklistheader">Related Information</div>
<ul class="linklist linklist relinfo">
<div class="linklistmember"><a class="link" href="ndv1557782188375.html" title="See the syntax details for Machine Learning Engine analytic functions with syntax elements that specify ( {'column' | column_range }[,...] ).">Column Specification Syntax Elements</a></div></ul>
</div></div>
<div class="topic reference nested1" aria-labelledby="ariaid-title3" topicindex="3" topicid="jlz1507837770702" xml:lang="en-us" lang="en-us" id="jlz1507837770702">
	<h2 class="title topictitle2" id="ariaid-title3">IPGeo Syntax Elements</h2>

	<div class="body refbody">
		<div class="section" id="jlz1507837770702__section_N10011_N1000E_N10001"><dl class="dl parml"><dt class="dt pt dlterm">IPAddressColumn</dt>
<dd class="dd pd">Specify the name of the input table column that contains the IP addresses.</dd>
<dt class="dt pt dlterm">Converter</dt>
<dd class="dd pd">[Optional] Specify the JAR filename and the name of the class that converts the IP address to location information.<div class="note note" id="jlz1507837770702__note_N10031_N1002D_N10026_N10018_N10014_N10010_N10001"><span class="notetitle">Note</span><div class="notebody"><span class="keyword">ML Engine</span> does not support the creation of new Converter classes. However, it does support existing JAR files—for installation instructions, see <span class="ph"><cite class="cite">Teradata Vantage™ User Guide</cite>, B700-4002</span>.</div></div>
</dd>
<dd class="dd pd ddexpand">The JAR file must be installed on <span class="keyword">ML Engine</span> and the class name must be the full name, including the package information. The file and class parameters are case-sensitive. The JAR file must contain all the classes that the user-defined converter needs.</dd>
<dd class="dd pd ddexpand">Default: Converter class that ships with IPGeo function (geolite 1.2.8)</dd>
<dt class="dt pt dlterm">Accumulate</dt>
<dd class="dd pd">[Optional] Specify the names of input table columns to copy to the output table.</dd>
</dl>
</div>

	</div>

</div>
<div class="topic reference nested1" aria-labelledby="ariaid-title4" topicindex="4" topicid="bgt1507837775181" xml:lang="en-us" lang="en-us" id="bgt1507837775181"><h2 class="title topictitle2" id="ariaid-title4">IPGeo Input</h2>
<div class="body refbody"><div class="section" id="bgt1507837775181__section_ybn_tdr_fdb"><h3 class="title sectiontitle">Input Table Schema</h3>
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="bgt1507837775181__table_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup><col style="width:23.076923076923077%" /><col style="width:15.384615384615385%" /><col style="width:61.53846153846154%" /></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d91539e226">Column</th>
<th class="entry nocellnorowborder" style="vertical-align:top;" id="d91539e228">Data Type</th>
<th class="entry cell-norowborder" style="vertical-align:top;" id="d91539e230">Description</th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e226 "><var class="keyword varname">ip_address_column</var></td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e228 ">VARCHAR</td>
<td class="entry cell-norowborder" style="vertical-align:top;" headers="d91539e230 ">IP address.</td>
</tr>
<tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d91539e226 "><var class="keyword varname">accumulate_column</var></td>
<td class="entry row-nocellborder" style="vertical-align:top;" headers="d91539e228 ">Any</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d91539e230 ">[Column appears once for each specified <var class="keyword varname">accumulate_column</var>.] <span class="ph">Column to copy to output table.</span> Typically, one such column is user identifier.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="topic reference nested1" aria-labelledby="ariaid-title5" topicindex="5" topicid="ykh1507837780669" xml:lang="en-us" lang="en-us" id="ykh1507837780669"><h2 class="title topictitle2" id="ariaid-title5">IPGeo Output</h2>
<div class="body refbody"><div class="section" id="ykh1507837780669__section_k55_vg5_pdb"><h3 class="title sectiontitle">Output Table Schema</h3>
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="ykh1507837780669__table_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup><col style="width:20%" /><col style="width:16%" /><col style="width:64%" /></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d91539e274">Column</th>
<th class="entry nocellnorowborder" style="vertical-align:top;" id="d91539e276">Data Type</th>
<th class="entry cell-norowborder" style="vertical-align:top;" id="d91539e278">Description</th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e274 ">country_code</td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e276 ">VARCHAR</td>
<td class="entry cell-norowborder" style="vertical-align:top;" headers="d91539e278 ">Country code.</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e274 ">country_name</td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e276 ">VARCHAR</td>
<td class="entry cell-norowborder" style="vertical-align:top;" headers="d91539e278 ">Country name.</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e274 ">state</td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e276 ">VARCHAR</td>
<td class="entry cell-norowborder" style="vertical-align:top;" headers="d91539e278 ">State or region name.</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e274 ">city</td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e276 ">VARCHAR</td>
<td class="entry cell-norowborder" style="vertical-align:top;" headers="d91539e278 ">City name.</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e274 ">postal_code</td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e276 ">VARCHAR</td>
<td class="entry cell-norowborder" style="vertical-align:top;" headers="d91539e278 ">Postal code.</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e274 ">latitude</td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e276 ">NUMERIC(6.4)</td>
<td class="entry cell-norowborder" style="vertical-align:top;" headers="d91539e278 ">Latitude.</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e274 ">longitude</td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e276 ">NUMERIC(7,4)</td>
<td class="entry cell-norowborder" style="vertical-align:top;" headers="d91539e278 ">Longitude.</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e274 ">isp</td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e276 ">VARCHAR</td>
<td class="entry cell-norowborder" style="vertical-align:top;" headers="d91539e278 ">ISP name.</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e274 ">organization</td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e276 ">VARCHAR</td>
<td class="entry cell-norowborder" style="vertical-align:top;" headers="d91539e278 ">Name of organization that owns IP address.</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e274 ">organization_type</td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e276 ">VARCHAR</td>
<td class="entry cell-norowborder" style="vertical-align:top;" headers="d91539e278 ">Organization type.</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e274 ">area_code</td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e276 ">INTEGER</td>
<td class="entry cell-norowborder" style="vertical-align:top;" headers="d91539e278 ">Area code.</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e274 ">metro_code</td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e276 ">INTEGER</td>
<td class="entry cell-norowborder" style="vertical-align:top;" headers="d91539e278 ">Metro code.</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e274 ">dma_code</td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d91539e276 ">INTEGER</td>
<td class="entry cell-norowborder" style="vertical-align:top;" headers="d91539e278 ">DMA code.</td>
</tr>
<tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d91539e274 "><var class="keyword varname">accumulate_column</var></td>
<td class="entry row-nocellborder" style="vertical-align:top;" headers="d91539e276 "><span class="ph">Same as in Input table</span></td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d91539e278 ">[Column appears once for each specified <var class="keyword varname">accumulate_column</var>.] <span class="ph">Column copied from input table.</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="topic concept nested1" aria-labelledby="ariaid-title6" topicindex="6" topicid="xxp1507837785588" xml:lang="en-us" lang="en-us" id="xxp1507837785588"><h2 class="title topictitle2" id="ariaid-title6">IPGeo Examples</h2>
<div class="body conbody"><div class="section" id="xxp1507837785588__section_N1000E_N1000C_N10001"><p class="p">The examples have the same input and output, but different <span class="keyword">SQL</span> calls.</p>
</div>
</div>
<div class="topic reference nested2" aria-labelledby="ariaid-title7" topicindex="7" topicid="yni1507837803257" xml:lang="en-us" lang="en-us" id="yni1507837803257"><h3 class="title topictitle3" id="ariaid-title7">IPGeo Example: IP Database Stored as ML Engine File</h3>
<div class="body refbody"><div class="section" id="yni1507837803257__section_N10011_N1000E_N10001"><p class="p">This example requires that the files MaxMindLite.jar, GeoLiteCity.dat, and GeoLiteCityv6.dat are installed on <span class="keyword">ML Engine</span>.</p>
</div>
<div class="section" id="yni1507837803257__section_kfy_zpr_t2b"><h4 class="title sectiontitle">Input</h4>
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="yni1507837803257__table_d5k_2qr_t2b" class="table" frame="border" border="1" rules="all"><div class="caption"><span class="tablecap">ipgeo_1</span></div><colgroup><col style="width:50%" /><col style="width:50%" /></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d91539e445">id</th>
<th class="entry cellrowborder" style="vertical-align:top;" id="d91539e447">ip</th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d91539e445 ">1</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d91539e447 ">159.41.1.23</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d91539e445 ">2</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d91539e447 ">153.65.16.10</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d91539e445 ">3</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d91539e447 ">75.36.209.106</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d91539e445 ">4</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d91539e447 ">202.106.0.20</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d91539e445 ">5</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d91539e447 ">69.236.77.51</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d91539e445 ">6</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d91539e447 ">168.187.7.114</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="yni1507837803257__section_kmz_sxj_1cb"><h4 class="title sectiontitle">SQL Call</h4><pre class="pre codeblock"><code>SELECT * FROM IPGeo (
  ON ipgeo_1
  USING
  IpAddressColumn ('ip')
  Converter ('MaxMindLite.jar',
            'com.asterdata.sqlmr.analytics.location.ipgeo.MaxMindLite')
  Accumulate ('id', 'ip')
) AS dt ;</code></pre></div>
<div class="section" id="yni1507837803257__section_f5y_qqr_t2b"><h4 class="title sectiontitle">Output</h4><pre class="pre screen"> id ip            country_code country_name  state      city          postal_code latitude longitude isp  organization organization_type area_code metro_code dma_code 
 -- ------------- ------------ ------------- ---------- ------------- ----------- -------- --------- ---- ------------ ----------------- --------- ---------- -------- 
  4 202.106.0.20  CN           China         Beijing    Beijing       NULL         39.9289  116.3883 NULL NULL         NULL                      0          0        0
  6 168.187.7.114 KW           Kuwait        Al Kuwayt  Kuwait        NULL         29.3697   47.9783 NULL NULL         NULL                      0          0        0
  5 69.236.77.51  US           United States California San Francisco NULL         37.7749 -122.4194 NULL NULL         NULL                    415        807      807
  3 75.36.209.106 US           United States California San Francisco NULL         37.7749 -122.4194 NULL NULL         NULL                    415        807      807
  1  159.41.1.23  US           United States Michigan   Saint Joseph  49085        42.0569  -86.4563 NULL NULL         NULL                    269        588      588
  2 153.65.16.10  US           United States Ohio       Miamisburg    45342        39.6182  -84.2488 NULL NULL         NULL                    937        542      542</pre>
<p class="p">Download a zip file of all examples and a SQL script file that creates their input tables from the download tab <img class="image" id="yni1507837803257__d21e16" src="enx1538431836629.png" /> in the left pane.</p>
</div>
</div>
</div>
<div class="topic reference nested2" aria-labelledby="ariaid-title8" topicindex="8" topicid="tpi1507837810931" xml:lang="en-us" lang="en-us" id="tpi1507837810931"><h3 class="title topictitle3" id="ariaid-title8">IPGeo Example: Default Maxmind Geolite Database</h3>
<div class="body refbody"><div class="section" id="tpi1507837810931__section_N10011_N1000E_N10001"><p class="p">This example uses the default Converter class that ships with the IPGeo function (geolite 1.2.8), and requires that the files GeoLiteCity.dat and GeoLiteCityv6.dat are installed on <span class="keyword">ML Engine</span>.</p>
</div>
<div class="section" id="tpi1507837810931__section_x5r_3qr_t2b"><h4 class="title sectiontitle">Input</h4><ul class="ul" id="tpi1507837810931__ul_hvg_jqr_t2b"><li class="li">Input table: ipgeo_1, as in <a class="xref" href="ktw1558450931654.html#yni1507837803257" title="See example of Machine Learning Engine function IPGeo that uses the IP address database stored as a ML Engine file.">IPGeo Example: IP Database Stored as ML Engine File</a></li>
</ul>
</div>
<div class="section" id="tpi1507837810931__section_hk1_wxj_1cb"><h4 class="title sectiontitle">SQL Call</h4><pre class="pre codeblock"><code>SELECT * FROM IPGeo(
  ON ipgeo_1
  USING
  IpAddressColumn('ip')
  Accumulate('id', 'ip')
) AS dt ;</code></pre></div>
<div class="section" id="tpi1507837810931__section_f5y_qqr_t2b"><h4 class="title sectiontitle">Output</h4><p class="p">The output is the same as in <a class="xref" href="ktw1558450931654.html#yni1507837803257" title="See example of Machine Learning Engine function IPGeo that uses the IP address database stored as a ML Engine file.">IPGeo Example: IP Database Stored as ML Engine File</a>.</p>
<pre class="pre screen"> id ip            country_code country_name  state      city          postal_code latitude longitude isp  organization organization_type area_code metro_code dma_code 
 -- ------------- ------------ ------------- ---------- ------------- ----------- -------- --------- ---- ------------ ----------------- --------- ---------- -------- 
  4 202.106.0.20  CN           China         Beijing    Beijing       NULL         39.9289  116.3883 NULL NULL         NULL                      0          0        0
  6 168.187.7.114 KW           Kuwait        Al Kuwayt  Kuwait        NULL         29.3697   47.9783 NULL NULL         NULL                      0          0        0
  5 69.236.77.51  US           United States California San Francisco NULL         37.7749 -122.4194 NULL NULL         NULL                    415        807      807
  3 75.36.209.106 US           United States California San Francisco NULL         37.7749 -122.4194 NULL NULL         NULL                    415        807      807
  1  159.41.1.23  US           United States Michigan   Saint Joseph  49085        42.0569  -86.4563 NULL NULL         NULL                    269        588      588
  2 153.65.16.10  US           United States Ohio       Miamisburg    45342        39.6182  -84.2488 NULL NULL         NULL                    937        542      542</pre>
<p class="p">Download a zip file of all examples and a SQL script file that creates their input tables from the download tab <img class="image" id="tpi1507837810931__d21e16" src="enx1538431836629.png" /> in the left pane.</p>
</div>
</div>
</div>
</div>
</div>
</body>
</html>