<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="copyright" content="(C) Copyright 2019, Teradata. All Rights Reserved." />
<meta name="DC.rights.owner" content="(C) Copyright 2019, Teradata. All Rights Reserved." />
<meta name="DC.Type" content="concept" />
<meta name="DC.Title" content="Canopy" />
<meta name="abstract" content="This Machine Learning Engine function groups objects into preliminary clusters, often the first step in more rigorous clustering techniques." />
<meta name="description" content="This Machine Learning Engine function groups objects into preliminary clusters, often the first step in more rigorous clustering techniques." />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="fqy1507664712684" />
<meta name="DC.Language" content="en-us" />

<link rel="stylesheet" type="text/css" href="css/normal_styles.css" />
<title>Canopy</title>
</head>
<body>
<div class="nested0" aria-labelledby="ariaid-title1" topicindex="1" topicid="fqy1507664712684" id="fqy1507664712684">
	<h1 class="title topictitle1" id="ariaid-title1">Canopy</h1>

	<div class="body conbody"><p class="p">Canopy clustering is a simple, fast, accurate method for grouping objects into preliminary clusters.  It is often performed in preparation for more rigorous clustering techniques, such as <var class="keyword varname">k</var>-means clustering.</p>
<p class="p">The canopy clustering algorithm uses a fast approximate distance metric and two distance thresholds, T<span class="ph sub">1</span> (loose distance) and T<span class="ph sub">2</span> (tight distance), with T<span class="ph sub">1</span> greater than T<span class="ph sub">2</span>. A point is assigned to a canopy if the distance from the point to the canopy center is less than T<span class="ph sub">2</span>, and can be assigned to a canopy if the distance from the point to the canopy center is less than T<span class="ph sub">1</span>. A point can be assigned to more than one canopy.</p>
<div class="note note" id="fqy1507664712684__note_N10017_N1000E_N1000C_N10001"><span class="notetitle">Note</span><div class="notebody"><ul class="ul" id="fqy1507664712684__ul_dfs_gx5_qx"><li class="li">For distance measurement, the Canopy function uses Euclidean distance.</li>
<li class="li">If there are more than 10,000 canopy centers, the function fails. Run the function again, increasing the value of T<span class="ph sub">2</span> (specified by the TightDistance syntax element).</li>
<li class="li">The canopy clustering algorithm is nondeterministic, and the randomness of the canopy assignments cannot be controlled by a seed syntax element (for more information, see <a class="xref" href="qym1549987102806.html" title="Learn why you can get different results from a Machine Learning Engine analytic function using the same input tables and syntax element values.">Nondeterministic Results and UniqueID Syntax Element</a>).</li>
</ul>
</div></div>

	</div>

<div class="topic reference nested1" aria-labelledby="ariaid-title2" topicindex="2" topicid="vtv1507664783941" xml:lang="en-us" lang="en-us" id="vtv1507664783941"><h2 class="title topictitle2" id="ariaid-title2">Canopy Syntax</h2>
<div class="body refbody"><div class="section" id="vtv1507664783941__section_N1000E_N1000C_N10001"><h3 class="title sectiontitle">Version 2.2</h3><pre class="pre codeblock"><code>SELECT * FROM Canopy (
  <span class="ph">ON { <var class="keyword varname">table</var> | <var class="keyword varname">view</var> | (<var class="keyword varname">query</var>) }</span> AS InputTable
  USING
  LooseDistance (<var class="keyword varname">maximum</var>)
  TightDistance (<var class="keyword varname">minimum</var>)
) AS <var class="keyword varname">alias</var>;</code></pre></div>
</div>
</div>
<div class="topic reference nested1" aria-labelledby="ariaid-title3" topicindex="3" topicid="xro1507664904827" xml:lang="en-us" lang="en-us" id="xro1507664904827">
	<h2 class="title topictitle2" id="ariaid-title3">Canopy Syntax Elements</h2>

	<div class="body refbody">
		<div class="section" id="xro1507664904827__section_N10011_N1000E_N10001"><dl class="dl parml"><dt class="dt pt dlterm">LooseDistance</dt>
<dd class="dd pd">Specify the maximum distance that any point can be from a canopy center to be considered part of that canopy (T<span class="ph sub">1</span>).</dd>
<dt class="dt pt dlterm">TightDistance</dt>
<dd class="dd pd">Specify the minimum distance that separates two canopy centers (T<span class="ph sub">2</span>).</dd>
</dl>
</div>

	</div>

</div>
<div class="topic reference nested1" aria-labelledby="ariaid-title4" topicindex="4" topicid="ciy1507664952328" xml:lang="en-us" lang="en-us" id="ciy1507664952328"><h2 class="title topictitle2" id="ariaid-title4">Canopy Input</h2>
<div class="body refbody"><div class="section" id="ciy1507664952328__section_N1000E_N1000C_N10001"><h3 class="title sectiontitle">InputTable Schema</h3><p class="p">The table can have only the columns described in the following table.</p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="ciy1507664952328__table_N10014_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup><col style="width:16.666666666666664%" /><col style="width:16.666666666666664%" /><col style="width:66.66666666666666%" /></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d407947e177">Column</th>
<th class="entry nocellnorowborder" style="vertical-align:top;" id="d407947e179">Data Type</th>
<th class="entry cell-norowborder" style="vertical-align:top;" id="d407947e181">Description</th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d407947e177 "><var class="keyword varname">id</var></td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d407947e179 ">Any</td>
<td class="entry cell-norowborder" style="vertical-align:top;" headers="d407947e181 ">Leftmost column. Row identifier.</td>
</tr>
<tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d407947e177 "><var class="keyword varname">dimension_i</var></td>
<td class="entry row-nocellborder" style="vertical-align:top;" headers="d407947e179 ">DOUBLE PRECISION</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e181 ">[Column appears once for each dimension.] Data in dimension <var class="keyword varname">i</var>.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="topic reference nested1" aria-labelledby="ariaid-title5" topicindex="5" topicid="nyk1507665004944" xml:lang="en-us" lang="en-us" id="nyk1507665004944"><h2 class="title topictitle2" id="ariaid-title5">Canopy Output</h2>
<div class="body refbody"><div class="section" id="nyk1507665004944__section_N1000E_N1000C_N10001"><h3 class="title sectiontitle">Output Table Schema</h3>
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="nyk1507665004944__table_N10014_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup><col style="width:18.51851851851852%" /><col style="width:14.814814814814813%" /><col style="width:66.66666666666666%" /></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d407947e222">Column</th>
<th class="entry nocellnorowborder" style="vertical-align:top;" id="d407947e224">Data Type</th>
<th class="entry cell-norowborder" style="vertical-align:top;" id="d407947e226">Description</th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d407947e222 ">canopyid</td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d407947e224 ">INTEGER</td>
<td class="entry cell-norowborder" style="vertical-align:top;" headers="d407947e226 ">Canopy identifier.</td>
</tr>
<tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d407947e222 "><var class="keyword varname">dimension_i</var></td>
<td class="entry row-nocellborder" style="vertical-align:top;" headers="d407947e224 ">DOUBLE PRECISION</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e226 ">[Column appears once for each dimension.] Canopy center for dimension <var class="keyword varname">i</var>.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="topic reference nested1" aria-labelledby="ariaid-title6" topicindex="6" topicid="pyq1510703406272" xml:lang="en-us" lang="en-us" id="pyq1510703406272"><h2 class="title topictitle2" id="ariaid-title6">Canopy Example</h2>
<div class="body refbody"><div class="section" id="pyq1510703406272__section_rlc_j5k_rdb"><h3 class="title sectiontitle">Input</h3><p class="p">The input table has more than 6000 rows of computer specifications.</p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="pyq1510703406272__table_nvz_v5k_rdb" class="table" frame="border" border="1" rules="all"><div class="caption"><span class="tablecap">InputTable: computers_train1</span></div><colgroup><col style="width:16.666666666666664%" /><col style="width:16.666666666666664%" /><col style="width:16.666666666666664%" /><col style="width:16.666666666666664%" /><col style="width:16.666666666666664%" /><col style="width:16.666666666666664%" /></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d407947e284">id</th>
<th class="entry cellrowborder" style="vertical-align:top;" id="d407947e286">price</th>
<th class="entry cellrowborder" style="vertical-align:top;" id="d407947e288">speed</th>
<th class="entry cellrowborder" style="vertical-align:top;" id="d407947e290">hd</th>
<th class="entry cellrowborder" style="vertical-align:top;" id="d407947e292">ram</th>
<th class="entry cellrowborder" style="vertical-align:top;" id="d407947e294">screen</th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e284 ">1</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e286 ">1499</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e288 ">25</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e290 ">80</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e292 ">4</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e294 ">14</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e284 ">2</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e286 ">1795</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e288 ">33</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e290 ">85</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e292 ">2</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e294 ">14</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e284 ">3</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e286 ">1595</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e288 ">25</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e290 ">170</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e292 ">4</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e294 ">15</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e284 ">4</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e286 ">1849</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e288 ">25</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e290 ">170</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e292 ">8</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e294 ">14</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e284 ">5</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e286 ">3295</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e288 ">33</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e290 ">340</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e292 ">16</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e294 ">14</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e284 ">6</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e286 ">3695</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e288 ">66</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e290 ">340</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e292 ">16</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e294 ">14</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e284 ">7</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e286 ">1720</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e288 ">25</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e290 ">170</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e292 ">4</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e294 ">14</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e284 ">8</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e286 ">1995</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e288 ">50</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e290 ">85</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e292 ">2</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e294 ">14</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e284 ">9</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e286 ">2225</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e288 ">50</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e290 ">210</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e292 ">2</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e294 ">14</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e284 ">12</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e286 ">2605</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e288 ">66</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e290 ">210</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e292 ">8</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e294 ">14</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e284 ">13</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e286 ">2045</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e288 ">50</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e290 ">130</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e292 ">4</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e294 ">14</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e284 ">14</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e286 ">2295</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e288 ">25</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e290 ">245</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e292 ">8</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e294 ">14</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e284 ">16</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e286 ">2225</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e288 ">50</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e290 ">130</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e292 ">4</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e294 ">14</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e284 ">17</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e286 ">1595</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e288 ">33</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e290 ">85</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e292 ">2</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e294 ">14</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e284 ">18</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e286 ">2325</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e288 ">33</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e290 ">210</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e292 ">4</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e294 ">15</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e284 ">19</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e286 ">2095</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e288 ">33</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e290 ">250</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e292 ">4</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e294 ">15</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e284 ">20</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e286 ">4395</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e288 ">66</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e290 ">452</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e292 ">8</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e294 ">14</td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e284 ">...</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e286 ">...</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e288 ">...</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e290 ">...</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e292 ">...</td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d407947e294 ">...</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="pyq1510703406272__section_w5m_j5k_rdb"><h3 class="title sectiontitle">SQL Call</h3><pre class="pre codeblock"><code>SELECT * FROM Canopy(
  ON computers_train1 AS InputTable
  USING
  LooseDistance(1000)
  TightDistance(500)
) AS dt;</code></pre></div>
<div class="section" id="pyq1510703406272__section_bhz_j5k_rdb"><h3 class="title sectiontitle">Output</h3><pre class="pre screen"> canopyid price            speed            hd               ram              screen           
 -------- ---------------- ---------------- ---------------- ---------------- ---------------- 
        1 3669.84615384615 57.2307692307692 363.153846153846 8.61538461538461 14.5384615384615
        2 1893.51282051282 34.6153846153846  156.25641025641 4.46153846153846 14.0769230769231
        3 2585.75471698113 45.4528301886792 227.320754716981 6.86792452830189 14.4339622641509</pre>
<p class="p">Download a zip file of all examples and a SQL script file that creates their input tables from the download tab <img class="image" id="pyq1510703406272__d21e16" src="enx1538431836629.png" /> in the left pane.</p>
</div>
</div>
</div>
</div>
</body>
</html>